language: go
go:
  - 1.6

before_install:
  - openssl aes-256-cbc -K $encrypted_de7a60f8584a_key -iv $encrypted_de7a60f8584a_iv
      -in MeanTweets-85af0b0f4ecf.json.enc -out MeanTweets-85af0b0f4ecf.json -d

install:
  # If the SDK is not already cached, download it and unpack it.
  - export GOOGLE_APPLICATION_CREDENTIALS=./MeanTweets-85af0b0f4ecf.json
  - export CLOUDSDK_CORE_DISABLE_PROMPTS=1
  - export CLOUDSDK_CORE_PROJECT=meantweets-1381
  - if [ ! -d ${HOME}/google-cloud-sdk ]; then
      curl https://sdk.cloud.google.com | bash;
    fi

  # Start the datastore emulator.
  - /home/travis/google-cloud-sdk/bin/gcloud beta emulators datastore start --no-legacy &

  # Install deps.
  - go get -t ./...

script:
  - go test -v ./...

